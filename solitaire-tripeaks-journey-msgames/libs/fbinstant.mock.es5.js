"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var SAMPLE_ERROR=["INVALID_PARAM","SAME_CONTEXT","NETWORK_FAILURE","PENDING_REQUEST","CLIENT_UNSUPPORTED_OPERATION"];function getRandomError(){return SAMPLE_ERROR[Math.floor(SAMPLE_ERROR.length*Math.random())]}var playersData=[],useLog=!1,maxPlayers=playersData.length,pName="Default Name",pId="1",pASID="1",pPhoto="",pSignature="1",FBUtils={log:function(){var e;if(useLog){var t=[];t.push("[FBInstantMock Mock]:");for(var n=0;n<arguments.length;n++)t.push(arguments[n]);(e=console).log.apply(e,t)}},getQueryString:function(){var e={};return location.search&&location.search.substr(1).split("&").forEach((function(t){var n=t.split("="),o=n[0],r=n[1]&&decodeURIComponent(n[1]);(e[o]=e[o]||[]).push(r)})),e},returnAndLog:function(e){return FBUtils.log(e),e},returnUserData:function(e){return FBInstantMock.__mockState.initialized?FBUtils.returnAndLog(e):(FBUtils.log("User Data is not available until startGameAsync has resolved"),null)},getFromLocalStorage:function(e,t){return new Promise((function(n){var o=localStorage.getItem(e),r={};o&&(o=JSON.parse(o),t.forEach((function(e){"undefined"!==o[e]&&(r[e]=o[e])}))),FBUtils.log(r),n(r)}))},writeToLocalStorage:function(e,t){return new Promise((function(n){var o=_objectSpread(_objectSpread({},JSON.parse(localStorage.getItem(e))),t);FBUtils.log(JSON.stringify(o)),localStorage.setItem(e,JSON.stringify(o)),n()}))}};function TournamentMock(e,t,n,o,r){this.id=e,this.contextID=t,this.title=n,this.endTime=o,this.payload=r,this.getPayload=function(){return this.payload}}TournamentMock.prototype.getID=function(){return this.id},TournamentMock.prototype.getContextID=function(){return this.contextID},TournamentMock.prototype.getPayLoad=function(){return this.payload},TournamentMock.prototype.getTitle=function(){return this.title},TournamentMock.prototype.getEndTime=function(){return this.endTime};var FBTournamentsMock={tournaments:[new TournamentMock("30343136292001808","24189868610646364","Weekly Tournament",Math.round(Date.now()/1e3)+86400,'{"leaderboardId":"688092e5a24a63446932a6e6"}')]},FBInstantMock={__mockState:{initialized:!1},leaderboard:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e+1;return t&&(n=15),{getRank:function(){return n},getScore:function(){return Math.floor(1e3/n)},getExtraData:function(){return JSON.stringify({})},getPlayer:function(){return FBInstantMock.leader(e,t)}}},leader:function(e,t){var n=Math.floor(Math.random()*Math.floor(200)),o=t?playersData[0]:{};return{getID:function(){return o.playerId||n},getName:function(){return o.name||"Bot ".concat(n)},getPhoto:function(){return o.photo||"https://api.adorable.io/avatars/285/".concat(n,"@adorable.png")}}},player:{getName:function(){return FBUtils.returnUserData(pName)},getPhoto:function(){return FBUtils.returnUserData(pPhoto)},getID:function(){return FBUtils.returnUserData(pId)},getASIDAsync:function(){return FBUtils.returnUserData(pASID)},getDataAsync:function(e){return FBUtils.log("player.getDataAsync"),FBUtils.getFromLocalStorage("fbPlayerData",e)},setDataAsync:function(e){return FBUtils.log("player.setDataAsync"),FBUtils.writeToLocalStorage("fbPlayerData",e)},flushDataAsync:function(){return new Promise((function(e){FBUtils.log("player.flushDataAsync"),FBUtils.writeToLocalStorage("fbPlayerData",{}).finally((function(){e()}))}))},getConnectedPlayersAsync:function(){return new Promise((function(e){var t=[];if(FBInstantMock.__mockState.initialized)for(var n=0;n<maxPlayers;n++){var o=playersData[n],r=o.playerId,i=o.name,a=o.photo;t.push({id:r,name:i,photo:a,getID:function(){return this.id},getName:function(){return this.name},getPhoto:function(){return this.photo}})}else FBUtils.log("getConnectedPlayersAsync","Connected players data is not available before startGameAsync resolves");FBUtils.log("getConnectedPlayersAsync","players: ",t),e(t)}))},getSignedPlayerInfoAsync:function(){return new Promise((function(e){e({getSignature:function(){return pSignature},getPlayerID:function(){return pId}})}))}},context:{id:FBUtils.getQueryString().context_source_id||"",type:FBUtils.getQueryString().context_type||"SOLO",getID:function(){return FBInstantMock.context.id},chooseAsync:function(){return new Promise((function(e,t){var n=createElementFromHTML('<div style="z-index: 1000000000; display: flex; align-items: center; height: 100%; width: 56vh;max-width:100vh; background-color: rgba(31, 120, 136, 0.48); position: absolute;margin:auto;left:0;right:0"></div'),o=(playersData.filter((function(e){return e.playerId!=pId})).map((function(t){var o=createElementFromHTML('<div style="cursor: pointer;width: 100%;height: 100px;background-color: rgb(255, 255, 255);color:black;display: flex;justify-content: space-evenly;align-items: center;z-index: inherit;"><div style="width: 85px;height: 85px;overflow: hidden;border-radius: 50%;"><img style="height:100%"src="'.concat(t.photo,'"/></div><p>').concat(t.name,'</p><button style="width:100px;height:70%;pointer-events:none">Play</button></div>\n                        '));return o.onclick=function(t){t.stopPropagation(),t.preventDefault(),FBUtils.log("context.chooseAsync"),FBInstantMock.context.id="123456789",FBInstantMock.context.type="THREAD",e(FBInstantMock.context.id),n.remove()},n.appendChild(o),o})),createElementFromHTML('<button style="width:100px;height:70px;cursor:pointer;position:absolute;right: 10px;top:10px">Close</button>'));o.onclick=function(e){e.stopPropagation(),e.preventDefault(),t({code:"USER_INPUT",message:"User close popup!"}),n.remove()},n.appendChild(o),FBUtils.log("context.chooseAsync"),FBInstantMock.context.id="123456789",FBInstantMock.context.type="THREAD",setTimeout((function(){100*Math.random()<window.GameCore.Configs.MatchMockFailRate?t({code:getRandomError(),message:"Random error"}):document.body.append(n)}),500)}))},switchAsync:function(e){return new Promise((function(t){FBUtils.log("context.switchAsync"),FBInstantMock.context.id=e,FBInstantMock.context.type="THREAD",t(e)}))},createAsync:function(){return new Promise((function(e,t){var n=playersData.filter((function(e){return e.playerId!=pId}))[0],o=createElementFromHTML('<div style="height: 40vh;width: 53vh;max-width: 95vw;position:absolute;background-color: rgba(31, 120, 136, 0.48);border-radius: 2vh;margin: auto;right: 0;left: 0;top: 0;bottom: 0;display: flex;flex-direction:column;justify-content:space-evenly;"><div style="display:flex; justify-content:center; width: 100%"><div style="width: 100px;height: 100px;overflow: hidden;border-radius: 50%;"><img style="height:100%"src="'.concat(pPhoto,'"/></div><div style="width: 100px;height: 100px;overflow: hidden;border-radius: 50%;"><img style="height:100%"src="').concat(n.photo,'"/></div></div><p style="color: white;font-size: 21px;text-align: center;margin: 10px 40px 10px 40px;">Send an invitation to play Game<br>through Messenger.</p></div>')),r=createElementFromHTML('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 20px;cursor: pointer;">Play</button>');r.onclick=function(t){t.stopPropagation(),t.preventDefault(),FBUtils.log("context.chooseAsync"),FBInstantMock.context.id="123456789",FBInstantMock.context.type="THREAD",e(FBInstantMock.context.id),o.remove()};var i=createElementFromHTML('<button style="border: none;background-color: #1877f2;color: #fff;width: 80px;height: 50px;font-size: 20px;cursor: pointer;position:absolute;top:10px;right:10px;border-radius: 10px;">Close</button>');i.onclick=function(e){e.stopPropagation(),e.preventDefault(),t({code:"USER_INPUT",message:"User close popup!"}),o.remove()},o.append(r),o.append(i),setTimeout((function(){100*Math.random()<window.GameCore.Configs.MatchMockFailRate?t({code:getRandomError(),message:"Random error"}):document.body.append(o)}),500)}))},getType:function(){return FBUtils.returnAndLog(FBInstantMock.context.type)},isSizeBetween:function(){return FBUtils.returnAndLog(!1)},getPlayersAsync:function(){return new Promise((function(e){var t=playersData.map((function(e){return{getID:function(){return e.playerId},getName:function(){return e.name},getPhoto:function(){return e.photo}}}));FBUtils.log("context.getPlayersAsync","players: ",t),e(t)}))}},getLocale:function(){return window.location.search.split("lang=")[1]||"vi_VN"},initializeAsync:function(){var e,t,n,o,r=(null===(e=window.GameCore)||void 0===e||null===(t=e.Configs)||void 0===t?void 0:t.PlayerMock)||{},i=(null===(n=window.GameCore)||void 0===n||null===(o=n.Configs)||void 0===o?void 0:o.OpponentMock)||{};playersData=[{name:r.name||"Mock1",photo:r.photo||"https://reqres.in/img/faces/2-image.jpg",playerId:r.id||"1",signature:r.signature||"1"},{name:i.name||"Mock2",photo:i.photo||"https://reqres.in/img/faces/3-image.jpg",playerId:i.id||"2",signature:i.signature||"2"},{name:"Mock3",photo:"https://reqres.in/img/faces/4-image.jpg",playerId:"3",signature:"3"},{name:"Mock4",photo:"https://reqres.in/img/faces/5-image.jpg",playerId:"4",signature:"4"},{name:"Mock5",photo:"https://reqres.in/img/faces/6-image.jpg",playerId:"5",signature:"5"},{name:"Mock6",photo:"https://reqres.in/img/faces/7-image.jpg",playerId:"6",signature:"6"},{name:"Mock7",photo:"https://reqres.in/img/faces/8-image.jpg",playerId:"7",signature:"7"},{name:"Mock8",photo:"https://reqres.in/img/faces/9-image.jpg",playerId:"8",signature:"8"},{name:"Mock9",photo:"https://reqres.in/img/faces/10-image.jpg",playerId:"9",signature:"9"},{name:"Mock10",photo:"https://reqres.in/img/faces/11-image.jpg",playerId:"10",signature:"10"},{name:"Mock11",photo:"https://reqres.in/img/faces/12-image.jpg",playerId:"11",signature:"11"},{name:"Mock12",photo:"https://reqres.in/img/faces/13-image.jpg",playerId:"12",signature:"12"},{name:"Mock13",photo:"https://reqres.in/img/faces/13-image.jpg",playerId:"13",signature:"13"},{name:"Mock14",photo:"https://reqres.in/img/faces/13-image.jpg",playerId:"14",signature:"14"},{name:"Mock15",photo:"https://reqres.in/img/faces/13-image.jpg",playerId:"15",signature:"15"},{name:"Mock16",photo:"https://reqres.in/img/faces/13-image.jpg",playerId:"16",signature:"16"},{name:"Mock17",photo:"https://reqres.in/img/faces/13-image.jpg",playerId:"17",signature:"17"},{name:"Mock18",photo:"https://reqres.in/img/faces/13-image.jpg",playerId:"18",signature:"18"},{name:"Mock19",photo:"https://reqres.in/img/faces/13-image.jpg",playerId:"19",signature:"19"},{name:"Mock20",photo:"https://reqres.in/img/faces/13-image.jpg",playerId:"20",signature:"20"},{name:"Mock21",photo:"https://reqres.in/img/faces/13-image.jpg",playerId:"21",signature:"21"},{name:"Mock22",photo:"https://reqres.in/img/faces/13-image.jpg",playerId:"22",signature:"22"},{name:"Mock23",photo:"https://reqres.in/img/faces/13-image.jpg",playerId:"23",signature:"23"},{name:"Mock24",photo:"https://reqres.in/img/faces/13-image.jpg",playerId:"24",signature:"24"}];for(var a=FBUtils.getQueryString(),s=0,c=1;c<playersData.length;c++)if(a.playerId&&a.playerId[0]===playersData[c].playerId){s=c;break}return maxPlayers=playersData.length,pName=playersData[s].name,pId=playersData[s].playerId,pPhoto=playersData[s].photo,pSignature=playersData[s].signature,new Promise((function(e){FBUtils.log("initializeAsync"),FBInstantMock.__mockState.initialized=!0,e()}))},setLoadingProgress:function(){},startGameAsync:function(){return new Promise((function(e){FBUtils.log("startGameAsync","Showing game start dialog"),FBInstantMock.__mockState.initialized=!0,e()}))},quit:function(){FBUtils.log("QUIT was called. At this point the game will exit")},updateAsync:function(e){return logMessage(e.data||{}),new Promise((function(t,n){FBUtils.log("updateAsync"),e.image?t():n()}))},getEntryPointData:function(){var e=FBUtils.getQueryString();return FBUtils.log("getEntryPointData","query string: ",e,"entry point data: ",e.entryPointData),e.entryPointData?JSON.parse(decodeURIComponent(e.entryPointData[0])):null},getEntryPointAsync:function(){return new Promise((function(e){e("admin_message")}))},setSessionData:function(e){FBUtils.log("setSessionData","Object to be persisted",e,"(Please note, while using the mock SDK, setSessionData will have no effect.)")},getPlatform:function(){var e="undefined"==typeof window?"":window.navigator.userAgent.toLowerCase(),t=function(t){return-1!==e.indexOf(t)},n={windows:function(){return t("windows")},blackberry:function(){return t("blackberry")||t("bb10")||t("rim")},fxos:function(){return(t("(mobile")||t("(tablet"))&&t(" rv:")},androidPhone:function(){return n.android()&&t("mobile")},androidTablet:function(){return n.android()&&!t("mobile")},blackberryPhone:function(){return n.blackberry()&&!t("tablet")},blackberryTablet:function(){return n.blackberry()&&t("tablet")},fxosPhone:function(){return n.fxos()&&t("mobile")},fxosTablet:function(){return n.fxos()&&t("tablet")},iphone:function(){return!n.windows()&&t("iphone")},ipad:function(){return t("ipad")},ipod:function(){return t("ipod")},meego:function(){return t("meego")},windowsPhone:function(){return n.windows()&&t("phone")},windowsTablet:function(){return n.windows()&&t("touch")&&!n.windowsPhone()},android:function(){return!n.windows()&&t("android")},ios:function(){return n.iphone()||n.ipod()||n.ipad()},mobile:function(){return n.androidPhone()||n.iphone()||n.ipod()||n.windowsPhone()||n.blackberryPhone()||n.fxosPhone()||n.meego()},tablet:function(){return n.ipad()||n.androidTablet()||n.blackberryTablet()||n.windowsTablet()||n.fxosTablet()}};if(n.ios())return"IOS";if(n.android())return"ANDROID";var o=n.mobile(),r=n.tablet();return o||r?"MOBILE_WEB":"WEB"},getSDKVersion:function(){return"6.3"},getSupportedAPIs:function(){var e=[];for(var t in FBInstantMock)e.push(t);for(var n in FBInstantMock.player)e.push("player.".concat(n));for(var o in FBInstantMock.context)e.push("context.".concat(o));return e},shareAsync:function(){return!0},switchGameAsync:function(){return Promise.reject(new Error("FBInstantMock.switchAsync is not available in the Mocked SDK."))},logEvent:function(){return null},onPause:function(e){window.onblur=function(){FBUtils.log("onPause","Interruption event triggered"),e()}},getLeaderboardAsync:function(){return Promise.resolve({getEntriesAsync:function(e,t){for(var n=[],o=0;o++;o<e)n.push(FBInstantMock.leaderboard(o+t));return Promise.resolve(n)},getConnectedPlayerEntriesAsync:function(e,t){for(var n=[],o=0;o++;o<e)n.push(FBInstantMock.leaderboard(o+t));return Promise.resolve(n)},getPlayerEntryAsync:function(){return Promise.resolve(FBInstantMock.leaderboard(0,!0))},setScoreAsync:function(){return Promise.resolve(FBInstantMock.leaderboard(0,!0))}})},postSessionScoreAsync:function(){return Promise.resolve()},loadBannerAdAsync:function(){return Promise.resolve()},hideBannerAdAsync:function(){return Promise.resolve()},getTournamentAsync:function(){return FBTournamentsMock.currentTournament?Promise.resolve(FBTournamentsMock.currentTournament):Promise.reject({code:"TOURNAMENT_NOT_FOUND",message:"A Tournament with current context was not found"})},tournament:{getTournamentsAsync:function(){return Promise.resolve(FBTournamentsMock.tournaments)},postScoreAsync:function(e){return Promise.resolve(!0)},shareAsync:function(e){return Promise.resolve()},joinAsync:function(e){var t=this;return new Promise(function(n,o){if(void 0==e)return void o({code:"INVALID_PARAM",message:"Invalid tournament id"});if(FBTournamentsMock.currentTournament?.getId()==e)return void o({code:"SAME_CONTEXT",message:"Must specify a context other than the current one."});const r=FBTournamentsMock.tournaments.find((t=>t.getID()==e));if(r){var i=this;_newArrowCheck(this,t);playersData.filter(function(e){return _newArrowCheck(this,i),e.playerId!=pId}.bind(this))[0];var a=createElementFromHTML('<div style="height: 28vh;width: 53vh;max-width: 95vw;position:absolute;background-color: #252728;border-radius: 2vh;margin: auto;right: 0;left: 0;top: 0;bottom: 0;display: flex;flex-direction:column;justify-content:space-evenly; font-family: Arial, Helvetica, sans-serif;"><div style="display:flex; justify-content:center; width: 100%"><div style="width: 150px;height: 150px;overflow: hidden;border-radius: 50%;"><img style="width:100%"src="'.concat(pPhoto,`"/></div></div><p style="color: white;font-size: 24px;text-align: center;margin: 10px 40px 10px 40px;">Play ${r.getTitle()}</p></div>`)),s=createElementFromHTML('<div style="\n                    z-index: 10000;\n                    width: 100%;\n                    height: 100%;\n                    position: absolute;\n                "></div>');s.appendChild(a);var c=createElementFromHTML('<button style="border: none;background-color: #1877f2;color: #fff;width: 90%;height: 50px;border-radius: 15px;margin-left: auto;margin-right: auto;font-size: 24px;cursor: pointer;">Play</button>');c.onclick=function(e){_newArrowCheck(this,i),e.stopPropagation(),e.preventDefault(),FBUtils.log("tournament.joinAsync"),FBTournamentsMock.currentTournament=r,n(r),s.remove()}.bind(this);var u=createElementFromHTML('<button style="border: none;background-color: #1877f2;color: #fff;width: 80px;height: 50px;font-size: 24px;cursor: pointer;position:absolute;top:15px;right:15px;border-radius: 10px;">Close</button>');u.onclick=function(e){_newArrowCheck(this,i),e.stopPropagation(),e.preventDefault(),o({code:"USER_INPUT",message:"Player closed the context menu!"}),s.remove()}.bind(this),a.append(c),a.append(u),setTimeout(function(){_newArrowCheck(this,i),100*Math.random()<window.GameCore.Configs.MatchMockFailRate?o({code:getRandomError(),message:"Random error"}):document.body.append(s)}.bind(this),200)}else o({code:"INVALID_PARAM",message:"Invalid tournament id"})}.bind(this))}}};window.FBInstant=FBInstantMock;var decode=function(e){var t={};return e.split("&").each((function(e){var n=e.split("="),o=n[0],r=unescape(n[1]);if(/\[\w+\]/.test(o)){var i=/\[(\w+)\]/g,a=/^([^\\[]+)/.exec(o)[0],s=i.exec(o);t[a]||(t[a]={});!function e(t){if(null!=s){var n=s[1];s=i.exec(o),t[n]||(t[n]=s?{}:r),e(t[n])}}(t[a])}else/\[\]$/.test(o)?(o=/(^\w+)/.exec(o)[0],t[o]||(t[o]=[]),t[o].push(r)):t[o]=r})),t},encode=function(e){return encodeURIComponent(JSON.stringify(e))},logMessage=function(e){var t=playersData[0].playerId===pId?playersData[1].playerId:playersData[0].playerId;console.log("Link to receive message: \n".concat(document.location.origin+document.location.pathname,"?playerId=").concat(t,"&context_source_id=123456789&context_type=THREAD&entryPointData=").concat(encode(e),"}"))};function createElementFromHTML(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}